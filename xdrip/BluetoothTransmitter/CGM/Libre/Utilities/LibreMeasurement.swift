import Foundation


/// Structure for one glucose measurement including value, date and raw data bytes
class LibreMeasurement {
    
    /// The date for this measurement
    let date: Date
    
    /// The minute counter for this measurement
    private let minuteCounter: Int
    
    /// The raw glucose as read from the sensor
    let rawGlucose: Int
    
    /// The raw temperature as read from the sensor
    let rawTemperature: Int
    
    /// slope to calculate glucose from raw value in (mg/dl)/raw
    let slope: Double
    
    /// glucose offset to be added in mg/dl
    let offset: Double
    
    /// The glucose value in mg/dl
    private let glucose: Double
    
    var temperatureAlgorithmGlucose: Double

    private let oopSlope: Double

    private let oopOffset: Double

    private let temperatureAlgorithmParameterSet: Libre1DerivedAlgorithmParameters?

    private let rawTemperatureAdjustment: Int
    
    /// - parameters :
    ///     - bytes:  raw data bytes as read from the sensor
    ///     - slope:  slope to calculate glucose from raw value in (mg/dl)/raw
    ///     - offset: glucose offset to be added in mg/dl
    ///     - date:   date of the measurement
    ///     - minuteCounter : minute counter of this measurement
    ///     - libre1DerivedAlgorithmParameters : Libre1DerivedAlgorithmParameters for the sensor
    init(bytes: Data, slope: Double = 0.1, offset: Double = 0.0, minuteCounter: Int = 0, date: Date, libre1DerivedAlgorithmParameters: Libre1DerivedAlgorithmParameters? = nil) {
        
        self.rawGlucose = (Int(bytes[1] & 0x1F) << 8) + Int(bytes[0]) // switched to 13 bit mask on 2018-03-15
        self.rawTemperature = (Int(bytes[4] & 0x3F) << 8)  + Int(bytes[3]) // 14 bit-mask for raw temperature
        self.slope = slope
        self.offset = offset
        self.glucose = offset + slope * Double(rawGlucose)
        self.date = date
        self.minuteCounter = minuteCounter
        
        let temperatureAdjustment = (LibreCalibrationInfo.readBits(bytes, 0, 0x26, 0x9) << 2)
        let negativeAdjustment = LibreCalibrationInfo.readBits(bytes, 0, 0x2f, 0x1) != 0;
        self.rawTemperatureAdjustment = negativeAdjustment ? -temperatureAdjustment : temperatureAdjustment
        
        // local algorithm
        self.temperatureAlgorithmParameterSet = libre1DerivedAlgorithmParameters
        if let libreDerivedAlgorithmParameterSet = self.temperatureAlgorithmParameterSet {
            self.oopSlope = libreDerivedAlgorithmParameterSet.slope_slope * Double(rawTemperature) + libreDerivedAlgorithmParameterSet.offset_slope
            self.oopOffset = libreDerivedAlgorithmParameterSet.slope_offset * Double(rawTemperature) + libreDerivedAlgorithmParameterSet.offset_offset
            //        self.oopSlope = slope_slope * Double(rawTemperature) + slope_offset
            //        self.oopOffset = offset_slope * Double(rawTemperature) + offset_offset
            let oopGlucose = oopSlope * Double(rawGlucose) + oopOffset
            //self.temperatureAlgorithmGlucose = oopGlucose
            // Final correction, if sensor values are very low and need to be compensated
            self.temperatureAlgorithmGlucose = oopGlucose * libreDerivedAlgorithmParameterSet.extraSlope + libreDerivedAlgorithmParameterSet.extraOffset
        } else {
            self.oopSlope = 0
            self.oopOffset = 0
            self.temperatureAlgorithmGlucose = 0
        }
    }
    
    /// this is the simplified Measurement, not used as real Measurement
    init(rawGlucose: Int, rawTemperature: Int) {
        
        self.rawGlucose = rawGlucose
        
        self.rawTemperature = rawTemperature
        
        self.rawTemperatureAdjustment = 0
        
        // default values for following parameters, as they will not be used
        date = Date()
        minuteCounter = 0
        slope = 0.0
        offset = 0.0
        glucose = 0.0
        temperatureAlgorithmGlucose = 0.0
        oopSlope = 0.0
        oopOffset = 0.0
        temperatureAlgorithmParameterSet = nil
        
    }
    
    init(rawGlucose: Int, rawTemperature: Int, minuteCounter: Int, date: Date, temperatureAdjustment: Int, libre1DerivedAlgorithmParameters: Libre1DerivedAlgorithmParameters?) {
        
        self.rawGlucose = rawGlucose
        
        self.rawTemperature = rawTemperature
        
        self.slope = 0.1
        
        self.offset = 0.0
        
        self.glucose = offset + slope * Double(rawGlucose)
        
        self.date = date
        
        self.minuteCounter = minuteCounter
        
        self.rawTemperatureAdjustment = temperatureAdjustment
        
        // local algorithm
        self.temperatureAlgorithmParameterSet = libre1DerivedAlgorithmParameters
        
        if let libreDerivedAlgorithmParameterSet = self.temperatureAlgorithmParameterSet {
            
            self.oopSlope = libreDerivedAlgorithmParameterSet.slope_slope * Double(rawTemperature) + libreDerivedAlgorithmParameterSet.offset_slope
            
            self.oopOffset = libreDerivedAlgorithmParameterSet.slope_offset * Double(rawTemperature) + libreDerivedAlgorithmParameterSet.offset_offset
            
            let oopGlucose = oopSlope * Double(rawGlucose) + oopOffset
            
            self.temperatureAlgorithmGlucose = oopGlucose * libreDerivedAlgorithmParameterSet.extraSlope + libreDerivedAlgorithmParameterSet.extraOffset
            
        } else {
            
            self.oopSlope = 0
            self.oopOffset = 0
            self.temperatureAlgorithmGlucose = 0
            
        }

    }
    
    func roundedGlucoseValueFromRaw(libreCalibrationInfo: LibreCalibrationInfo) -> Int {
        Int(round(glucoseValueFromRaw(libreCalibrationInfo: libreCalibrationInfo)))
    }
    
    func roundedGlucoseValueFromRaw2(libreCalibrationInfo: LibreCalibrationInfo) -> Double{
        round(glucoseValueFromRaw(libreCalibrationInfo: libreCalibrationInfo))
    }
    
    func glucoseValueFromRaw(libreCalibrationInfo: LibreCalibrationInfo) -> Double {
        let x : Double = 1000 + 71500;
        let y : Double = 1000;
        
        let ca = 0.0009180023;
        let cb = 0.0001964561;
        let cc = 0.0000007061775;
        let cd = 0.00000005283566;
        
        let rawTemperature = Double(self.rawTemperature)
        let rawTemperatureAdjustment = Double(self.rawTemperatureAdjustment)
        let rawGlucose = Double(self.rawGlucose)
        
        let rLeft = rawTemperature * x
        let rRight = rawTemperatureAdjustment + libreCalibrationInfo.i6
        
        
        let R  = ( rLeft / rRight ) - y; 
        
        
        let logR  = log(R)
        
        let d  = pow(logR, 3) * cd + pow(logR, 2) * cc + logR * cb + ca
        
        let temperature = 1 / d - 273.15;
        
        let g1 = 65.0 * (rawGlucose - libreCalibrationInfo.i3) / (libreCalibrationInfo.i4 - libreCalibrationInfo.i3);
        let g2 = pow(1.045, 32.5 - temperature);
        
        
        let g3 = g1 * g2
        
        let v1 = t1[libreCalibrationInfo.i2 - 1]
        let v2 = t2[libreCalibrationInfo.i2 - 1]
        
        let res = (g3 - v1) / v2;
        
        return  res
        
    }
    
}

fileprivate let t1 = [
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    0.75, 1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75, 3,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75, 3,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75, 3,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75, 3,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75, 3,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75, 3,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75, 3,
    1, 1.25, 1.5, 1.75, 2, 2.25, 2.5, 2.75, 3,
];

fileprivate let t2 = [
    0.037744199999999999, 0.037744199999999999, 0.037744199999999999, 0.037744199999999999, 0.037744199999999999, 0.037744199999999999, 0.037744199999999999, 0.037744199999999999,
    0.038121700000000001, 0.038121700000000001, 0.038121700000000001, 0.038121700000000001, 0.038121700000000001, 0.038121700000000001, 0.038121700000000001, 0.038121700000000001,
    0.0385029, 0.0385029, 0.0385029, 0.0385029, 0.0385029, 0.0385029, 0.0385029, 0.0385029,
    0.038887900000000003, 0.038887900000000003, 0.038887900000000003, 0.038887900000000003, 0.038887900000000003, 0.038887900000000003, 0.038887900000000003, 0.038887900000000003,
    0.039276800000000001, 0.039276800000000001, 0.039276800000000001, 0.039276800000000001, 0.039276800000000001, 0.039276800000000001, 0.039276800000000001, 0.039276800000000001,
    0.039669599999999999, 0.039669599999999999, 0.039669599999999999, 0.039669599999999999, 0.039669599999999999, 0.039669599999999999, 0.039669599999999999, 0.039669599999999999,
    0.040066299999999999, 0.040066299999999999, 0.040066299999999999, 0.040066299999999999, 0.040066299999999999, 0.040066299999999999, 0.040066299999999999, 0.040066299999999999,
    0.0404669, 0.0404669, 0.0404669, 0.0404669, 0.0404669, 0.0404669, 0.0404669, 0.0404669,
    0.040871600000000001, 0.040871600000000001, 0.040871600000000001, 0.040871600000000001, 0.040871600000000001, 0.040871600000000001, 0.040871600000000001, 0.040871600000000001,
    0.041280299999999999, 0.041280299999999999, 0.041280299999999999, 0.041280299999999999, 0.041280299999999999, 0.041280299999999999, 0.041280299999999999, 0.041280299999999999,
    0.041693099999999997, 0.041693099999999997, 0.041693099999999997, 0.041693099999999997, 0.041693099999999997, 0.041693099999999997, 0.041693099999999997, 0.041693099999999997,
    0.042110000000000002, 0.042110000000000002, 0.042110000000000002, 0.042110000000000002, 0.042110000000000002, 0.042110000000000002, 0.042110000000000002, 0.042110000000000002,
    0.042531100000000002, 0.042531100000000002, 0.042531100000000002, 0.042531100000000002, 0.042531100000000002, 0.042531100000000002, 0.042531100000000002, 0.042531100000000002,
    0.042956500000000002, 0.042956500000000002, 0.042956500000000002, 0.042956500000000002, 0.042956500000000002, 0.042956500000000002, 0.042956500000000002, 0.042956500000000002,
    0.043386000000000001, 0.043386000000000001, 0.043386000000000001, 0.043386000000000001, 0.043386000000000001, 0.043386000000000001, 0.043386000000000001, 0.043386000000000001,
    0.043819900000000002, 0.043819900000000002, 0.043819900000000002, 0.043819900000000002, 0.043819900000000002, 0.043819900000000002, 0.043819900000000002, 0.043819900000000002,
    0.044258100000000002, 0.044258100000000002, 0.044258100000000002, 0.044258100000000002, 0.044258100000000002, 0.044258100000000002, 0.044258100000000002, 0.044258100000000002,
    0.044700700000000003, 0.044700700000000003, 0.044700700000000003, 0.044700700000000003, 0.044700700000000003, 0.044700700000000003, 0.044700700000000003, 0.044700700000000003,
    0.045147699999999999, 0.045147699999999999, 0.045147699999999999, 0.045147699999999999, 0.045147699999999999, 0.045147699999999999, 0.045147699999999999, 0.045147699999999999,
    0.045599099999999997, 0.045599099999999997, 0.045599099999999997, 0.045599099999999997, 0.045599099999999997, 0.045599099999999997, 0.045599099999999997, 0.045599099999999997,
    0.046055100000000002, 0.046055100000000002, 0.046055100000000002, 0.046055100000000002, 0.046055100000000002, 0.046055100000000002, 0.046055100000000002, 0.046055100000000002,
    0.0465157, 0.0465157, 0.0465157, 0.0465157, 0.0465157, 0.0465157, 0.0465157, 0.0465157,
    0.046980800000000003, 0.046980800000000003, 0.046980800000000003, 0.046980800000000003, 0.046980800000000003, 0.046980800000000003, 0.046980800000000003, 0.046980800000000003,
    0.047450600000000002, 0.047450600000000002, 0.047450600000000002, 0.047450600000000002, 0.047450600000000002, 0.047450600000000002, 0.047450600000000002, 0.047450600000000002,
    0.047925200000000001, 0.047925200000000001, 0.047925200000000001, 0.047925200000000001, 0.047925200000000001, 0.047925200000000001, 0.047925200000000001, 0.047925200000000001,
    0.0484044, 0.0484044, 0.0484044, 0.0484044, 0.0484044, 0.0484044, 0.0484044, 0.0484044,
    0.048888399999999999, 0.048888399999999999, 0.048888399999999999, 0.048888399999999999, 0.048888399999999999, 0.048888399999999999, 0.048888399999999999, 0.048888399999999999,
    0.049377299999999999, 0.049377299999999999, 0.049377299999999999, 0.049377299999999999, 0.049377299999999999, 0.049377299999999999, 0.049377299999999999, 0.049377299999999999,
    0.049871100000000002, 0.049871100000000002, 0.049871100000000002, 0.049871100000000002, 0.049871100000000002, 0.049871100000000002, 0.049871100000000002, 0.049871100000000002,
    0.050369799999999999, 0.050369799999999999, 0.050369799999999999, 0.050369799999999999, 0.050369799999999999, 0.050369799999999999, 0.050369799999999999, 0.050369799999999999,
    0.050873500000000002, 0.050873500000000002, 0.050873500000000002, 0.050873500000000002, 0.050873500000000002, 0.050873500000000002, 0.050873500000000002, 0.050873500000000002,
    0.051382299999999999, 0.051382299999999999, 0.051382299999999999, 0.051382299999999999, 0.051382299999999999, 0.051382299999999999, 0.051382299999999999, 0.051382299999999999,
    0.051896100000000001, 0.051896100000000001, 0.051896100000000001, 0.051896100000000001, 0.051896100000000001, 0.051896100000000001, 0.051896100000000001, 0.051896100000000001,
    0.052415000000000003, 0.052415000000000003, 0.052415000000000003, 0.052415000000000003, 0.052415000000000003, 0.052415000000000003, 0.052415000000000003, 0.052415000000000003,
    0.052939199999999999, 0.052939199999999999, 0.052939199999999999, 0.052939199999999999, 0.052939199999999999, 0.052939199999999999, 0.052939199999999999, 0.052939199999999999,
    0.053468599999999998, 0.053468599999999998, 0.053468599999999998, 0.053468599999999998, 0.053468599999999998, 0.053468599999999998, 0.053468599999999998, 0.053468599999999998,
    0.054003299999999997, 0.054003299999999997, 0.054003299999999997, 0.054003299999999997, 0.054003299999999997, 0.054003299999999997, 0.054003299999999997, 0.054003299999999997,
    0.054543300000000003, 0.054543300000000003, 0.054543300000000003, 0.054543300000000003, 0.054543300000000003, 0.054543300000000003, 0.054543300000000003, 0.054543300000000003,
    0.055088699999999997, 0.055088699999999997, 0.055088699999999997, 0.055088699999999997, 0.055088699999999997, 0.055088699999999997, 0.055088699999999997, 0.055088699999999997,
    0.055639599999999997, 0.055639599999999997, 0.055639599999999997, 0.055639599999999997, 0.055639599999999997, 0.055639599999999997, 0.055639599999999997, 0.055639599999999997,
    0.056196000000000003, 0.056196000000000003, 0.056196000000000003, 0.056196000000000003, 0.056196000000000003, 0.056196000000000003, 0.056196000000000003, 0.056196000000000003,
    0.056758000000000003, 0.056758000000000003, 0.056758000000000003, 0.056758000000000003, 0.056758000000000003, 0.056758000000000003, 0.056758000000000003, 0.056758000000000003,
    0.057325599999999997, 0.057325599999999997, 0.057325599999999997, 0.057325599999999997, 0.057325599999999997, 0.057325599999999997, 0.057325599999999997, 0.057325599999999997,
    0.0578988, 0.0578988, 0.0578988, 0.0578988, 0.0578988, 0.0578988, 0.0578988, 0.0578988,
    0.058477800000000003, 0.058477800000000003, 0.058477800000000003, 0.058477800000000003, 0.058477800000000003, 0.058477800000000003, 0.058477800000000003, 0.058477800000000003,
    0.0590626, 0.0590626, 0.0590626, 0.0590626, 0.0590626, 0.0590626, 0.0590626, 0.0590626,
    0.059653200000000003, 0.059653200000000003, 0.059653200000000003, 0.059653200000000003, 0.059653200000000003, 0.059653200000000003, 0.059653200000000003, 0.059653200000000003,
    0.060249700000000003, 0.060249700000000003, 0.060249700000000003, 0.060249700000000003, 0.060249700000000003, 0.060249700000000003, 0.060249700000000003, 0.060249700000000003,
    0.060852200000000002, 0.060852200000000002, 0.060852200000000002, 0.060852200000000002, 0.060852200000000002, 0.060852200000000002, 0.060852200000000002, 0.060852200000000002,
    0.0614607, 0.0614607, 0.0614607, 0.0614607, 0.0614607, 0.0614607, 0.0614607, 0.0614607,
    0.062075400000000003, 0.062075400000000003, 0.062075400000000003, 0.062075400000000003, 0.062075400000000003, 0.062075400000000003, 0.062075400000000003, 0.062075400000000003,
    0.062696100000000005, 0.062696100000000005, 0.062696100000000005, 0.062696100000000005, 0.062696100000000005, 0.062696100000000005, 0.062696100000000005, 0.062696100000000005,
    0.063323099999999993, 0.063323099999999993, 0.063323099999999993, 0.063323099999999993, 0.063323099999999993, 0.063323099999999993, 0.063323099999999993, 0.063323099999999993,
    0.063956299999999994, 0.063956299999999994, 0.063956299999999994, 0.063956299999999994, 0.063956299999999994, 0.063956299999999994, 0.063956299999999994, 0.063956299999999994,
    0.064595899999999998, 0.064595899999999998, 0.064595899999999998, 0.064595899999999998, 0.064595899999999998, 0.064595899999999998, 0.064595899999999998, 0.064595899999999998,
    0.065241800000000003, 0.065241800000000003, 0.065241800000000003, 0.065241800000000003, 0.065241800000000003, 0.065241800000000003, 0.065241800000000003, 0.065241800000000003,
    0.0658942, 0.0658942, 0.0658942, 0.0658942, 0.0658942, 0.0658942, 0.0658942, 0.0658942,
    0.066553200000000007, 0.066553200000000007, 0.066553200000000007, 0.066553200000000007, 0.066553200000000007, 0.066553200000000007, 0.066553200000000007, 0.066553200000000007,
    0.067218700000000006, 0.067218700000000006, 0.067218700000000006, 0.067218700000000006, 0.067218700000000006, 0.067218700000000006, 0.067218700000000006, 0.067218700000000006,
    0.067890900000000004, 0.067890900000000004, 0.067890900000000004, 0.067890900000000004, 0.067890900000000004, 0.067890900000000004, 0.067890900000000004, 0.067890900000000004,
    0.0685698, 0.0685698, 0.0685698, 0.0685698, 0.0685698, 0.0685698, 0.0685698, 0.0685698,
    0.069255499999999998, 0.069255499999999998, 0.069255499999999998, 0.069255499999999998, 0.069255499999999998, 0.069255499999999998, 0.069255499999999998, 0.069255499999999998,
    0.069948099999999999, 0.069948099999999999, 0.069948099999999999, 0.069948099999999999, 0.069948099999999999, 0.069948099999999999, 0.069948099999999999, 0.069948099999999999,
    0.070647500000000002, 0.070647500000000002, 0.070647500000000002, 0.070647500000000002, 0.070647500000000002, 0.070647500000000002, 0.070647500000000002, 0.070647500000000002,
    0.071354000000000001, 0.071354000000000001, 0.071354000000000001, 0.071354000000000001, 0.071354000000000001, 0.071354000000000001, 0.071354000000000001, 0.071354000000000001, 0.071354000000000001,
    0.072067599999999996, 0.072067599999999996, 0.072067599999999996, 0.072067599999999996, 0.072067599999999996, 0.072067599999999996, 0.072067599999999996, 0.072067599999999996, 0.072067599999999996,
    0.072788199999999997, 0.072788199999999997, 0.072788199999999997, 0.072788199999999997, 0.072788199999999997, 0.072788199999999997, 0.072788199999999997, 0.072788199999999997, 0.072788199999999997,
    0.073516100000000001, 0.073516100000000001, 0.073516100000000001, 0.073516100000000001, 0.073516100000000001, 0.073516100000000001, 0.073516100000000001, 0.073516100000000001, 0.073516100000000001,
    0.074251300000000006, 0.074251300000000006, 0.074251300000000006, 0.074251300000000006, 0.074251300000000006, 0.074251300000000006, 0.074251300000000006, 0.074251300000000006, 0.074251300000000006,
    0.074993799999999999, 0.074993799999999999, 0.074993799999999999, 0.074993799999999999, 0.074993799999999999, 0.074993799999999999, 0.074993799999999999, 0.074993799999999999, 0.074993799999999999,
    0.075743699999999997, 0.075743699999999997, 0.075743699999999997, 0.075743699999999997, 0.075743699999999997, 0.075743699999999997, 0.075743699999999997, 0.075743699999999997, 0.075743699999999997,
    0.076501200000000005, 0.076501200000000005, 0.076501200000000005, 0.076501200000000005, 0.076501200000000005, 0.076501200000000005, 0.076501200000000005, 0.076501200000000005, 0.076501200000000005,
    0.077266199999999993, 0.077266199999999993, 0.077266199999999993, 0.077266199999999993, 0.077266199999999993, 0.077266199999999993, 0.077266199999999993, 0.077266199999999993, 0.077266199999999993,
    0.078038800000000005, 0.078038800000000005, 0.078038800000000005, 0.078038800000000005, 0.078038800000000005, 0.078038800000000005, 0.078038800000000005, 0.078038800000000005, 0.078038800000000005,
    0.078819200000000006, 0.078819200000000006, 0.078819200000000006, 0.078819200000000006, 0.078819200000000006, 0.078819200000000006, 0.078819200000000006, 0.078819200000000006, 0.078819200000000006,
    0.079607399999999995, 0.079607399999999995, 0.079607399999999995, 0.079607399999999995, 0.079607399999999995, 0.079607399999999995, 0.079607399999999995, 0.079607399999999995, 0.079607399999999995,
    0.080403500000000003, 0.080403500000000003, 0.080403500000000003, 0.080403500000000003, 0.080403500000000003, 0.080403500000000003, 0.080403500000000003, 0.080403500000000003, 0.080403500000000003,
    0.081207500000000002, 0.081207500000000002, 0.081207500000000002, 0.081207500000000002, 0.081207500000000002, 0.081207500000000002, 0.081207500000000002, 0.081207500000000002, 0.081207500000000002,
    0.082019599999999998, 0.082019599999999998, 0.082019599999999998, 0.082019599999999998, 0.082019599999999998, 0.082019599999999998, 0.082019599999999998, 0.082019599999999998, 0.082019599999999998,
    0.082839800000000005, 0.082839800000000005, 0.082839800000000005, 0.082839800000000005, 0.082839800000000005, 0.082839800000000005, 0.082839800000000005, 0.082839800000000005, 0.082839800000000005,
    0.083668199999999998, 0.083668199999999998, 0.083668199999999998, 0.083668199999999998, 0.083668199999999998, 0.083668199999999998, 0.083668199999999998, 0.083668199999999998, 0.083668199999999998,
    0.084504899999999994, 0.084504899999999994, 0.084504899999999994, 0.084504899999999994, 0.084504899999999994, 0.084504899999999994, 0.084504899999999994, 0.084504899999999994, 0.084504899999999994,
    0.085349900000000006, 0.085349900000000006, 0.085349900000000006, 0.085349900000000006, 0.085349900000000006, 0.085349900000000006, 0.085349900000000006, 0.085349900000000006, 0.085349900000000006,
    0.086203399999999999, 0.086203399999999999, 0.086203399999999999, 0.086203399999999999, 0.086203399999999999, 0.086203399999999999, 0.086203399999999999, 0.086203399999999999, 0.086203399999999999,
    0.087065500000000004, 0.087065500000000004, 0.087065500000000004, 0.087065500000000004, 0.087065500000000004, 0.087065500000000004, 0.087065500000000004, 0.087065500000000004, 0.087065500000000004,
    0.087936100000000003, 0.087936100000000003, 0.087936100000000003, 0.087936100000000003, 0.087936100000000003, 0.087936100000000003, 0.087936100000000003, 0.087936100000000003, 0.087936100000000003,
    0.088815500000000006, 0.088815500000000006, 0.088815500000000006, 0.088815500000000006, 0.088815500000000006, 0.088815500000000006, 0.088815500000000006, 0.088815500000000006, 0.088815500000000006,
    0.089703599999999994, 0.089703599999999994, 0.089703599999999994, 0.089703599999999994, 0.089703599999999994, 0.089703599999999994, 0.089703599999999994, 0.089703599999999994,
    0.090600700000000006, 0.090600700000000006, 0.090600700000000006, 0.090600700000000006, 0.090600700000000006, 0.090600700000000006, 0.090600700000000006, 0.090600700000000006,
    0.091506699999999996, 0.091506699999999996, 0.091506699999999996, 0.091506699999999996, 0.091506699999999996, 0.091506699999999996, 0.091506699999999996, 0.091506699999999996,
    0.092421699999999996, 0.092421699999999996, 0.092421699999999996, 0.092421699999999996, 0.092421699999999996, 0.092421699999999996, 0.092421699999999996, 0.092421699999999996,
    0.093345999999999998, 0.093345999999999998, 0.093345999999999998, 0.093345999999999998, 0.093345999999999998, 0.093345999999999998, 0.093345999999999998, 0.093345999999999998,
    0.094279399999999999, 0.094279399999999999, 0.094279399999999999, 0.094279399999999999, 0.094279399999999999, 0.094279399999999999, 0.094279399999999999, 0.094279399999999999,
    0.095222200000000007, 0.095222200000000007, 0.095222200000000007, 0.095222200000000007, 0.095222200000000007, 0.095222200000000007, 0.095222200000000007, 0.095222200000000007,
    0.096174399999999993, 0.096174399999999993, 0.096174399999999993, 0.096174399999999993, 0.096174399999999993, 0.096174399999999993, 0.096174399999999993, 0.096174399999999993,
    0.097136200000000006, 0.097136200000000006, 0.097136200000000006, 0.097136200000000006, 0.097136200000000006, 0.097136200000000006, 0.097136200000000006, 0.097136200000000006,
    0.0981075, 0.0981075, 0.0981075, 0.0981075, 0.0981075, 0.0981075, 0.0981075, 0.0981075,
    0.099088599999999999, 0.099088599999999999, 0.099088599999999999, 0.099088599999999999, 0.099088599999999999, 0.099088599999999999, 0.099088599999999999, 0.099088599999999999,
    0.1000795, 0.1000795, 0.1000795, 0.1000795, 0.1000795, 0.1000795, 0.1000795, 0.1000795,
    0.1010803, 0.1010803, 0.1010803, 0.1010803, 0.1010803, 0.1010803, 0.1010803, 0.1010803,
    0.1020911, 0.1020911, 0.1020911, 0.1020911, 0.1020911, 0.1020911, 0.1020911, 0.1020911,
    0.103112, 0.103112, 0.103112, 0.103112, 0.103112, 0.103112, 0.103112, 0.103112,
    0.1041431, 0.1041431, 0.1041431, 0.1041431, 0.1041431, 0.1041431, 0.1041431, 0.1041431,
    0.1051846, 0.1051846, 0.1051846, 0.1051846, 0.1051846, 0.1051846, 0.1051846, 0.1051846,
    0.10623639999999999, 0.10623639999999999, 0.10623639999999999, 0.10623639999999999, 0.10623639999999999, 0.10623639999999999, 0.10623639999999999, 0.10623639999999999,
    0.1072988, 0.1072988, 0.1072988, 0.1072988, 0.1072988, 0.1072988, 0.1072988, 0.1072988,
    0.1083718, 0.1083718, 0.1083718, 0.1083718, 0.1083718, 0.1083718, 0.1083718, 0.1083718,
    0.1094555, 0.1094555, 0.1094555, 0.1094555, 0.1094555, 0.1094555, 0.1094555, 0.1094555,
    0.11055, 0.11055, 0.11055, 0.11055, 0.11055, 0.11055, 0.11055, 0.11055,
    0.1116555, 0.1116555, 0.1116555, 0.1116555, 0.1116555, 0.1116555, 0.1116555, 0.1116555,
    0.1127721, 0.1127721, 0.1127721, 0.1127721, 0.1127721, 0.1127721, 0.1127721, 0.1127721,
    0.1138998, 0.1138998, 0.1138998, 0.1138998, 0.1138998, 0.1138998, 0.1138998, 0.1138998,
    0.1150388, 0.1150388, 0.1150388, 0.1150388, 0.1150388, 0.1150388, 0.1150388, 0.1150388,
    0.11618920000000001, 0.11618920000000001, 0.11618920000000001, 0.11618920000000001, 0.11618920000000001, 0.11618920000000001, 0.11618920000000001, 0.11618920000000001,
    0.1173511, 0.1173511, 0.1173511, 0.1173511, 0.1173511, 0.1173511, 0.1173511, 0.1173511,
    0.11852459999999999, 0.11852459999999999, 0.11852459999999999, 0.11852459999999999, 0.11852459999999999, 0.11852459999999999, 0.11852459999999999, 0.11852459999999999,
    0.11970989999999999, 0.11970989999999999, 0.11970989999999999, 0.11970989999999999, 0.11970989999999999, 0.11970989999999999, 0.11970989999999999, 0.11970989999999999, 0.11970989999999999,
    0.120907, 0.120907, 0.120907, 0.120907, 0.120907, 0.120907, 0.120907, 0.120907, 0.120907,
    0.122116, 0.122116, 0.122116, 0.122116, 0.122116, 0.122116, 0.122116, 0.122116, 0.122116,
    0.12333719999999999, 0.12333719999999999, 0.12333719999999999, 0.12333719999999999, 0.12333719999999999, 0.12333719999999999, 0.12333719999999999, 0.12333719999999999, 0.12333719999999999,
    0.1245706, 0.1245706, 0.1245706, 0.1245706, 0.1245706, 0.1245706, 0.1245706, 0.1245706, 0.1245706,
    0.12581629999999999, 0.12581629999999999, 0.12581629999999999, 0.12581629999999999, 0.12581629999999999, 0.12581629999999999, 0.12581629999999999, 0.12581629999999999, 0.12581629999999999,
    0.1270744, 0.1270744, 0.1270744, 0.1270744, 0.1270744, 0.1270744, 0.1270744, 0.1270744, 0.1270744,
    0.12834519999999999, 0.12834519999999999, 0.12834519999999999, 0.12834519999999999, 0.12834519999999999, 0.12834519999999999, 0.12834519999999999, 0.12834519999999999, 0.12834519999999999,
];
